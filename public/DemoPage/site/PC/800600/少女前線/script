window.fbAsyncInit = function() { FB.init({ appId : '1779831265661799', xfbml : true, status: true, cookie: true, oauth: true, version : 'v2.12' }); }; (function(d, s, id){ var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) {return;} js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/zh_TW/sdk.js"; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk')); function facebook_login() { var perms = 'public_profile,email'; FB.login(function(response){ if (response.authResponse){ var token = response.authResponse.accessToken; FB.api('/me', function(response){ location.href = '/members/login_with_facebook/' + token; }); }else{ FB.Event.subscribe('auth.login', function(response){ var token = response.authResponse.accessToken; if(response.authResponse){ FB.api('/me', function(response){ location.href = '/members/login_with_facebook/' + token; }); } }); } }, { scope: perms }); } $(function(){ $('#facebook_login').click(function(){ facebook_login(); return false; }); });