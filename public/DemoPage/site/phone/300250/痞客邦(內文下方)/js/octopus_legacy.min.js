!function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}var e=t(function(t){!function(e){var n,o=Object.prototype,r=o.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag",l=e.regeneratorRuntime;if(l)t.exports=l;else{(l=e.regeneratorRuntime=t.exports).wrap=y;var u="suspendedStart",h="suspendedYield",f="executing",d="completed",p={},v={};v[a]=function(){return this};var _=Object.getPrototypeOf,g=_&&_(_(L([])));g&&g!==o&&r.call(g,a)&&(v=g);var m=E.prototype=b.prototype=Object.create(v);k.prototype=m.constructor=E,E.constructor=k,E[s]=k.displayName="GeneratorFunction",l.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===k||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,E):(t.__proto__=E,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(m),t},l.awrap=function(t){return{__await:t}},x(P.prototype),P.prototype[c]=function(){return this},l.AsyncIterator=P,l.async=function(t,e,n,o){var r=new P(y(t,e,n,o));return l.isGeneratorFunction(e)?r:r.next().then(function(t){return t.done?t.value:r.next()})},x(m),m[s]="Generator",m[a]=function(){return this},m.toString=function(){return"[object Generator]"},l.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var o=e.pop();if(o in t)return n.value=o,n.done=!1,n}return n.done=!0,n}},l.values=L,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(o,r){return c.type="throw",c.arg=t,e.next=o,r&&(e.method="next",e.arg=n),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var r=o.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,o){return this.delegate={iterator:L(t),resultName:e,nextLoc:o},"next"===this.method&&(this.arg=n),p}}}function y(t,e,n,o){var r,i,a,c,s=e&&e.prototype instanceof b?e:b,l=Object.create(s.prototype),v=new j(o||[]);return l._invoke=(r=t,i=n,a=v,c=u,function(t,e){if(c===f)throw new Error("Generator is already running");if(c===d){if("throw"===t)throw e;return N()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){var o=S(n,a);if(o){if(o===p)continue;return o}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(c===u)throw c=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);c=f;var s=w(r,i,a);if("normal"===s.type){if(c=a.done?d:h,s.arg===p)continue;return{value:s.arg,done:a.done}}"throw"===s.type&&(c=d,a.method="throw",a.arg=s.arg)}}),l}function w(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function b(){}function k(){}function E(){}function x(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function P(t){var e;this._invoke=function(n,o){function i(){return new Promise(function(e,i){!function e(n,o,i,a){var c=w(t[n],t,o);if("throw"!==c.type){var s=c.arg,l=s.value;return l&&"object"==typeof l&&r.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,i,a)},function(t){e("throw",t,i,a)}):Promise.resolve(l).then(function(t){s.value=t,i(s)},a)}a(c.arg)}(n,o,e,i)})}return e=e?e.then(i,i):i()}}function S(t,e){var o=t.iterator[e.method];if(o===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,S(t,e),"throw"===e.method))return p;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=w(o,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,p;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function L(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function e(){for(;++o<t.length;)if(r.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return i.next=i}}return{next:N}}function N(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())}),n=function(){return this}()||Function("return this")(),o=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,r=o&&n.regeneratorRuntime;n.regeneratorRuntime=void 0;var i=e;if(o)n.regeneratorRuntime=r;else try{delete n.regeneratorRuntime}catch(t){n.regeneratorRuntime=void 0}var a=i,c=Math.ceil,s=Math.floor,l=function(t){return isNaN(t=+t)?0:(t>0?s:c)(t)},u=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},h=t(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),f=t(function(t){var e=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=e)}),d=(f.version,function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}),p=function(t,e,n){if(d(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,o){return t.call(e,n,o)};case 3:return function(n,o,r){return t.call(e,n,o,r)}}return function(){return t.apply(e,arguments)}},v=function(t){return"object"==typeof t?null!==t:"function"==typeof t},_=function(t){if(!v(t))throw TypeError(t+" is not an object!");return t},g=function(t){try{return!!t()}catch(t){return!0}},m=!g(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),y=h.document,w=v(y)&&v(y.createElement),b=function(t){return w?y.createElement(t):{}},k=!m&&!g(function(){return 7!=Object.defineProperty(b("div"),"a",{get:function(){return 7}}).a}),E=function(t,e){if(!v(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!v(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!v(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!v(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")},x=Object.defineProperty,P={f:m?Object.defineProperty:function(t,e,n){if(_(t),e=E(e,!0),_(n),k)try{return x(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},S=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},O=m?function(t,e,n){return P.f(t,e,S(1,n))}:function(t,e,n){return t[e]=n,t},T="prototype",j=function(t,e,n){var o,r,i,a=t&j.F,c=t&j.G,s=t&j.S,l=t&j.P,u=t&j.B,d=t&j.W,v=c?f:f[e]||(f[e]={}),_=v[T],g=c?h:s?h[e]:(h[e]||{})[T];c&&(n=e);for(o in n)(r=!a&&g&&void 0!==g[o])&&o in v||(i=r?g[o]:n[o],v[o]=c&&"function"!=typeof g[o]?n[o]:u&&r?p(i,h):d&&g[o]==i?function(t){var e=function(e,n,o){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,o)}return t.apply(this,arguments)};return e[T]=t[T],e}(i):l&&"function"==typeof i?p(Function.call,i):i,l&&((v.virtual||(v.virtual={}))[o]=i,t&j.R&&_&&!_[o]&&O(_,o,i)))};j.F=1,j.G=2,j.S=4,j.P=8,j.B=16,j.W=32,j.U=64,j.R=128;var L,N=j,D=O,C={}.hasOwnProperty,H=function(t,e){return C.call(t,e)},A={},R={}.toString,B=function(t){return R.call(t).slice(8,-1)},M=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==B(t)?t.split(""):Object(t)},I=function(t){return M(u(t))},G=Math.min,z=function(t){return t>0?G(l(t),9007199254740991):0},F=Math.max,q=Math.min,W="__core-js_shared__",Z=h[W]||(h[W]={}),V=function(t){return Z[t]||(Z[t]={})},Y=0,U=Math.random(),K=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++Y+U).toString(36))},J=V("keys"),$=function(t){return J[t]||(J[t]=K(t))},X=(L=!1,function(t,e,n){var o,r,i,a=I(t),c=z(a.length),s=(r=c,(o=l(o=n))<0?F(o+r,0):q(o,r));if(L&&e!=e){for(;c>s;)if((i=a[s++])!=i)return!0}else for(;c>s;s++)if((L||s in a)&&a[s]===e)return L||s||0;return!L&&-1}),Q=$("IE_PROTO"),tt=function(t,e){var n,o=I(t),r=0,i=[];for(n in o)n!=Q&&H(o,n)&&i.push(n);for(;e.length>r;)H(o,n=e[r++])&&(~X(i,n)||i.push(n));return i},et="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),nt=Object.keys||function(t){return tt(t,et)},ot=m?Object.defineProperties:function(t,e){_(t);for(var n,o=nt(e),r=o.length,i=0;r>i;)P.f(t,n=o[i++],e[n]);return t},rt=h.document,it=rt&&rt.documentElement,at=$("IE_PROTO"),ct=function(){},st="prototype",lt=function(){var t,e=b("iframe"),n=et.length;for(e.style.display="none",it.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),lt=t.F;n--;)delete lt[st][et[n]];return lt()},ut=Object.create||function(t,e){var n;return null!==t?(ct[st]=_(t),n=new ct,ct[st]=null,n[at]=t):n=lt(),void 0===e?n:ot(n,e)},ht=t(function(t){var e=V("wks"),n=h.Symbol,o="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=o&&n[t]||(o?n:K)("Symbol."+t))}).store=e}),ft=P.f,dt=ht("toStringTag"),pt=function(t,e,n){t&&!H(t=n?t:t.prototype,dt)&&ft(t,dt,{configurable:!0,value:e})},vt={};O(vt,ht("iterator"),function(){return this});var _t,gt=function(t){return Object(u(t))},mt=$("IE_PROTO"),yt=Object.prototype,wt=Object.getPrototypeOf||function(t){return t=gt(t),H(t,mt)?t[mt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?yt:null},bt=ht("iterator"),kt=!([].keys&&"next"in[].keys()),Et="values",xt=function(){return this},Pt=function(t,e,n,o,r,i,a){var c,s,l;s=e,l=o,(c=n).prototype=ut(vt,{next:S(1,l)}),pt(c,s+" Iterator");var u,h,f,d=function(t){if(!kt&&t in g)return g[t];switch(t){case"keys":case Et:return function(){return new n(this,t)}}return function(){return new n(this,t)}},p=e+" Iterator",v=r==Et,_=!1,g=t.prototype,m=g[bt]||g["@@iterator"]||r&&g[r],y=!kt&&m||d(r),w=r?v?d("entries"):y:void 0,b="Array"==e&&g.entries||m;if(b&&(f=wt(b.call(new t)))!==Object.prototype&&f.next&&pt(f,p,!0),v&&m&&m.name!==Et&&(_=!0,y=function(){return m.call(this)}),a&&(kt||_||!g[bt])&&O(g,bt,y),A[e]=y,A[p]=xt,r)if(u={values:v?y:d(Et),keys:i?y:d("keys"),entries:w},a)for(h in u)h in g||D(g,h,u[h]);else N(N.P+N.F*(kt||_),e,u);return u},St=(_t=!0,function(t,e){var n,o,r=String(u(t)),i=l(e),a=r.length;return i<0||i>=a?_t?"":void 0:(n=r.charCodeAt(i))<55296||n>56319||i+1===a||(o=r.charCodeAt(i+1))<56320||o>57343?_t?r.charAt(i):n:_t?r.slice(i,i+2):o-56320+(n-55296<<10)+65536});Pt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=St(e,n),this._i+=t.length,{value:t,done:!1})});var Ot=function(t,e){return{value:e,done:!!t}};Pt(Array,"Array",function(t,e){this._t=I(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,Ot(1)):Ot(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");A.Arguments=A.Array;for(var Tt=ht("toStringTag"),jt="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Lt=0;Lt<jt.length;Lt++){var Nt=jt[Lt],Dt=h[Nt],Ct=Dt&&Dt.prototype;Ct&&!Ct[Tt]&&O(Ct,Tt,Nt),A[Nt]=A.Array}var Ht,At,Rt,Bt=ht("toStringTag"),Mt="Arguments"==B(function(){return arguments}()),It=function(t){var e,n,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Bt))?n:Mt?B(e):"Object"==(o=B(e))&&"function"==typeof e.callee?"Arguments":o},Gt=function(t,e,n,o){try{return o?e(_(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&_(r.call(t)),e}},zt=ht("iterator"),Ft=Array.prototype,qt=function(t){return void 0!==t&&(A.Array===t||Ft[zt]===t)},Wt=ht("iterator"),Zt=f.getIteratorMethod=function(t){if(void 0!=t)return t[Wt]||t["@@iterator"]||A[It(t)]},Vt=t(function(t){var e={},n={},o=t.exports=function(t,o,r,i,a){var c,s,l,u,h=a?function(){return t}:Zt(t),f=p(r,i,o?2:1),d=0;if("function"!=typeof h)throw TypeError(t+" is not iterable!");if(qt(h)){for(c=z(t.length);c>d;d++)if((u=o?f(_(s=t[d])[0],s[1]):f(t[d]))===e||u===n)return u}else for(l=h.call(t);!(s=l.next()).done;)if((u=Gt(l,f,s.value,o))===e||u===n)return u};o.BREAK=e,o.RETURN=n}),Yt=ht("species"),Ut=function(t,e){var n,o=_(t).constructor;return void 0===o||void 0==(n=_(o)[Yt])?e:d(n)},Kt=h.process,Jt=h.setImmediate,$t=h.clearImmediate,Xt=h.MessageChannel,Qt=h.Dispatch,te=0,ee={},ne="onreadystatechange",oe=function(){var t=+this;if(ee.hasOwnProperty(t)){var e=ee[t];delete ee[t],e()}},re=function(t){oe.call(t.data)};Jt&&$t||(Jt=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return ee[++te]=function(){!function(t,e,n){var o=void 0===n;switch(e.length){case 0:return o?t():t.call(n);case 1:return o?t(e[0]):t.call(n,e[0]);case 2:return o?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return o?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return o?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}t.apply(n,e)}("function"==typeof t?t:Function(t),e)},Ht(te),te},$t=function(t){delete ee[t]},"process"==B(Kt)?Ht=function(t){Kt.nextTick(p(oe,t,1))}:Qt&&Qt.now?Ht=function(t){Qt.now(p(oe,t,1))}:Xt?(Rt=(At=new Xt).port2,At.port1.onmessage=re,Ht=p(Rt.postMessage,Rt,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(Ht=function(t){h.postMessage(t+"","*")},h.addEventListener("message",re,!1)):Ht=ne in b("script")?function(t){it.appendChild(b("script"))[ne]=function(){it.removeChild(this),oe.call(t)}}:function(t){setTimeout(p(oe,t,1),0)});var ie={set:Jt,clear:$t},ae=ie.set,ce=h.MutationObserver||h.WebKitMutationObserver,se=h.process,le=h.Promise,ue="process"==B(se);var he={f:function(t){return new function(t){var e,n;this.promise=new t(function(t,o){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=o}),this.resolve=d(e),this.reject=d(n)}(t)}},fe=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},de=function(t,e){if(_(t),v(e)&&e.constructor===t)return e;var n=he.f(t);return(0,n.resolve)(e),n.promise},pe=ht("species"),ve=ht("iterator"),_e=!1;try{[7][ve]().return=function(){_e=!0}}catch(t){}var ge,me,ye,we,be,ke,Ee=function(t,e){if(!e&&!_e)return!1;var n=!1;try{var o=[7],r=o[ve]();r.next=function(){return{done:n=!0}},o[ve]=function(){return r},t(o)}catch(t){}return n},xe=ie.set,Pe=function(){var t,e,n,o=function(){var o,r;for(ue&&(o=se.domain)&&o.exit();t;){r=t.fn,t=t.next;try{r()}catch(o){throw t?n():e=void 0,o}}e=void 0,o&&o.enter()};if(ue)n=function(){se.nextTick(o)};else if(!ce||h.navigator&&h.navigator.standalone)if(le&&le.resolve){var r=le.resolve();n=function(){r.then(o)}}else n=function(){ae.call(h,o)};else{var i=!0,a=document.createTextNode("");new ce(o).observe(a,{characterData:!0}),n=function(){a.data=i=!i}}return function(o){var r={fn:o,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}(),Se="Promise",Oe=h.TypeError,Te=h.process,je=h[Se],Le="process"==It(Te),Ne=function(){},De=me=he.f,Ce=!!function(){try{var t=je.resolve(1),e=(t.constructor={})[ht("species")]=function(t){t(Ne,Ne)};return(Le||"function"==typeof PromiseRejectionEvent)&&t.then(Ne)instanceof e}catch(t){}}(),He=function(t){var e;return!(!v(t)||"function"!=typeof(e=t.then))&&e},Ae=function(t,e){if(!t._n){t._n=!0;var n=t._c;Pe(function(){for(var o=t._v,r=1==t._s,i=0,a=function(e){var n,i,a=r?e.ok:e.fail,c=e.resolve,s=e.reject,l=e.domain;try{a?(r||(2==t._h&&Me(t),t._h=1),!0===a?n=o:(l&&l.enter(),n=a(o),l&&l.exit()),n===e.promise?s(Oe("Promise-chain cycle")):(i=He(n))?i.call(n,c,s):c(n)):s(o)}catch(t){s(t)}};n.length>i;)a(n[i++]);t._c=[],t._n=!1,e&&!t._h&&Re(t)})}},Re=function(t){xe.call(h,function(){var e,n,o,r=t._v,i=Be(t);if(i&&(e=fe(function(){Le?Te.emit("unhandledRejection",r,t):(n=h.onunhandledrejection)?n({promise:t,reason:r}):(o=h.console)&&o.error&&o.error("Unhandled promise rejection",r)}),t._h=Le||Be(t)?2:1),t._a=void 0,i&&e.e)throw e.v})},Be=function(t){return 1!==t._h&&0===(t._a||t._c).length},Me=function(t){xe.call(h,function(){var e;Le?Te.emit("rejectionHandled",t):(e=h.onrejectionhandled)&&e({promise:t,reason:t._v})})},Ie=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),Ae(e,!0))},Ge=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw Oe("Promise can't be resolved itself");(e=He(t))?Pe(function(){var o={_w:n,_d:!1};try{e.call(t,p(Ge,o,1),p(Ie,o,1))}catch(t){Ie.call(o,t)}}):(n._v=t,n._s=1,Ae(n,!1))}catch(t){Ie.call({_w:n,_d:!1},t)}}};Ce||(je=function(t){!function(t,e,n,o){if(!(t instanceof e)||void 0!==o&&o in t)throw TypeError(n+": incorrect invocation!")}(this,je,Se,"_h"),d(t),ge.call(this);try{t(p(Ge,this,1),p(Ie,this,1))}catch(t){Ie.call(this,t)}},(ge=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,n){for(var o in e)n&&t[o]?t[o]=e[o]:O(t,o,e[o]);return t}(je.prototype,{then:function(t,e){var n=De(Ut(this,je));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=Le?Te.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Ae(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),ye=function(){var t=new ge;this.promise=t,this.resolve=p(Ge,t,1),this.reject=p(Ie,t,1)},he.f=De=function(t){return t===je||t===we?new ye(t):me(t)}),N(N.G+N.W+N.F*!Ce,{Promise:je}),pt(je,Se),ke="function"==typeof f[be=Se]?f[be]:h[be],m&&ke&&!ke[pe]&&P.f(ke,pe,{configurable:!0,get:function(){return this}}),we=f[Se],N(N.S+N.F*!Ce,Se,{reject:function(t){var e=De(this);return(0,e.reject)(t),e.promise}}),N(N.S+!0*N.F,Se,{resolve:function(t){return de(this===we?je:this,t)}}),N(N.S+N.F*!(Ce&&Ee(function(t){je.all(t).catch(Ne)})),Se,{all:function(t){var e=this,n=De(e),o=n.resolve,r=n.reject,i=fe(function(){var n=[],i=0,a=1;Vt(t,!1,function(t){var c=i++,s=!1;n.push(void 0),a++,e.resolve(t).then(function(t){s||(s=!0,n[c]=t,--a||o(n))},r)}),--a||o(n)});return i.e&&r(i.v),n.promise},race:function(t){var e=this,n=De(e),o=n.reject,r=fe(function(){Vt(t,!1,function(t){e.resolve(t).then(n.resolve,o)})});return r.e&&o(r.v),n.promise}}),N(N.P+N.R,"Promise",{finally:function(t){var e=Ut(this,f.Promise||h.Promise),n="function"==typeof t;return this.then(n?function(n){return de(e,t()).then(function(){return n})}:t,n?function(n){return de(e,t()).then(function(){throw n})}:t)}}),N(N.S,"Promise",{try:function(t){var e=he.f(this),n=fe(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}});var ze=f.Promise;var Fe=function(t){return function(){var e=this,n=arguments;return new ze(function(o,r){var i=t.apply(e,n);function a(t,e){try{var n=i[t](e),a=n.value}catch(t){return void r(t)}n.done?o(a):ze.resolve(a).then(c,s)}function c(t){a("next",t)}function s(t){a("throw",t)}c()})}},qe=function(t,e,n){e in t?P.f(t,e,S(0,n)):t[e]=n};N(N.S+N.F*!Ee(function(t){}),"Array",{from:function(t){var e,n,o,r,i=gt(t),a="function"==typeof this?this:Array,c=arguments.length,s=c>1?arguments[1]:void 0,l=void 0!==s,u=0,h=Zt(i);if(l&&(s=p(s,c>2?arguments[2]:void 0,2)),void 0==h||a==Array&&qt(h))for(n=new a(e=z(i.length));e>u;u++)qe(n,u,l?s(i[u],u):i[u]);else for(r=h.call(i),n=new a;!(o=r.next()).done;u++)qe(n,u,l?Gt(r,s,[o.value,u],!0):o.value);return n.length=u,n}});var We=f.Array.from;var Ze=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};N(N.S+N.F*!m,"Object",{defineProperty:P.f});var Ve=f.Object,Ye=function(t,e,n){return Ve.defineProperty(t,e,n)};function Ue(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Ye(t,o.key,o)}}var Ke=function(t,e,n){return e&&Ue(t.prototype,e),n&&Ue(t,n),t},Je=function(t){var e=new RegExp("[?&]".concat(t,"=([^&]*)")).exec(window.location.search);return e&&decodeURIComponent(e[1].replace(/\+/g," "))},$e={post:function(t,e){return this.request("POST",t,e)},get:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.request("GET",t,e)},request:function(t,e,n){return new ze(function(o,r){var i=new XMLHttpRequest;i.open(t,e,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.withCredentials=!0,i.onload=function(){4===i.readyState&&200===i.status&&""!==i.response?o(JSON.parse(i.response)):r(i)},i.onerror=function(){r(i)},i.send(n)})}},Xe=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.getFullYear(),o="0".concat(t.getMonth()+1).slice(-2),r="0".concat(t.getDate()).slice(-2);return e?"".concat(n," 年 ").concat(o," 月 ").concat(r," 日"):"".concat(n,"-").concat(o,"-").concat(r)},Qe=function(t){return t.replace(/ /g,"_")},tn=function(t){var e=document.createElement("script");e.text=t.innerHTML;for(var n=t.attributes.length-1;n>=0;n--)e.setAttribute(t.attributes[n].name,t.attributes[n].value);return e},en=function(t,e){var n=(f.Object||{})[t]||Object[t],o={};o[t]=e(n),N(N.S+N.F*g(function(){n(1)}),"Object",o)};en("getPrototypeOf",function(){return function(t){return wt(gt(t))}});var nn=f.Object.getPrototypeOf,on={f:ht},rn=on.f("iterator"),an=t(function(t){var e=K("meta"),n=P.f,o=0,r=Object.isExtensible||function(){return!0},i=!g(function(){return r(Object.preventExtensions({}))}),a=function(t){n(t,e,{value:{i:"O"+ ++o,w:{}}})},c=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!v(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!H(t,e)){if(!r(t))return"F";if(!n)return"E";a(t)}return t[e].i},getWeak:function(t,n){if(!H(t,e)){if(!r(t))return!0;if(!n)return!1;a(t)}return t[e].w},onFreeze:function(t){return i&&c.NEED&&r(t)&&!H(t,e)&&a(t),t}}}),cn=(an.KEY,an.NEED,an.fastKey,an.getWeak,an.onFreeze,P.f),sn=function(t){var e=f.Symbol||(f.Symbol={});"_"==t.charAt(0)||t in e||cn(e,t,{value:on.f(t)})},ln={f:Object.getOwnPropertySymbols},un={f:{}.propertyIsEnumerable},hn=Array.isArray||function(t){return"Array"==B(t)},fn=et.concat("length","prototype"),dn={f:Object.getOwnPropertyNames||function(t){return tt(t,fn)}},pn=dn.f,vn={}.toString,_n="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],gn={f:function(t){return _n&&"[object Window]"==vn.call(t)?function(t){try{return pn(t)}catch(t){return _n.slice()}}(t):pn(I(t))}},mn=Object.getOwnPropertyDescriptor,yn={f:m?mn:function(t,e){if(t=I(t),e=E(e,!0),k)try{return mn(t,e)}catch(t){}if(H(t,e))return S(!un.f.call(t,e),t[e])}},wn=an.KEY,bn=yn.f,kn=P.f,En=gn.f,xn=h.Symbol,Pn=h.JSON,Sn=Pn&&Pn.stringify,On="prototype",Tn=ht("_hidden"),jn=ht("toPrimitive"),Ln={}.propertyIsEnumerable,Nn=V("symbol-registry"),Dn=V("symbols"),Cn=V("op-symbols"),Hn=Object[On],An="function"==typeof xn,Rn=h.QObject,Bn=!Rn||!Rn[On]||!Rn[On].findChild,Mn=m&&g(function(){return 7!=ut(kn({},"a",{get:function(){return kn(this,"a",{value:7}).a}})).a})?function(t,e,n){var o=bn(Hn,e);o&&delete Hn[e],kn(t,e,n),o&&t!==Hn&&kn(Hn,e,o)}:kn,In=function(t){var e=Dn[t]=ut(xn[On]);return e._k=t,e},Gn=An&&"symbol"==typeof xn.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof xn},zn=function(t,e,n){return t===Hn&&zn(Cn,e,n),_(t),e=E(e,!0),_(n),H(Dn,e)?(n.enumerable?(H(t,Tn)&&t[Tn][e]&&(t[Tn][e]=!1),n=ut(n,{enumerable:S(0,!1)})):(H(t,Tn)||kn(t,Tn,S(1,{})),t[Tn][e]=!0),Mn(t,e,n)):kn(t,e,n)},Fn=function(t,e){_(t);for(var n,o=function(t){var e=nt(t),n=ln.f;if(n)for(var o,r=n(t),i=un.f,a=0;r.length>a;)i.call(t,o=r[a++])&&e.push(o);return e}(e=I(e)),r=0,i=o.length;i>r;)zn(t,n=o[r++],e[n]);return t},qn=function(t){var e=Ln.call(this,t=E(t,!0));return!(this===Hn&&H(Dn,t)&&!H(Cn,t))&&(!(e||!H(this,t)||!H(Dn,t)||H(this,Tn)&&this[Tn][t])||e)},Wn=function(t,e){if(t=I(t),e=E(e,!0),t!==Hn||!H(Dn,e)||H(Cn,e)){var n=bn(t,e);return!n||!H(Dn,e)||H(t,Tn)&&t[Tn][e]||(n.enumerable=!0),n}},Zn=function(t){for(var e,n=En(I(t)),o=[],r=0;n.length>r;)H(Dn,e=n[r++])||e==Tn||e==wn||o.push(e);return o},Vn=function(t){for(var e,n=t===Hn,o=En(n?Cn:I(t)),r=[],i=0;o.length>i;)!H(Dn,e=o[i++])||n&&!H(Hn,e)||r.push(Dn[e]);return r};An||(D((xn=function(){if(this instanceof xn)throw TypeError("Symbol is not a constructor!");var t=K(arguments.length>0?arguments[0]:void 0),e=function(n){this===Hn&&e.call(Cn,n),H(this,Tn)&&H(this[Tn],t)&&(this[Tn][t]=!1),Mn(this,t,S(1,n))};return m&&Bn&&Mn(Hn,t,{configurable:!0,set:e}),In(t)})[On],"toString",function(){return this._k}),yn.f=Wn,P.f=zn,dn.f=gn.f=Zn,un.f=qn,ln.f=Vn,on.f=function(t){return In(ht(t))}),N(N.G+N.W+N.F*!An,{Symbol:xn});for(var Yn="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Un=0;Yn.length>Un;)ht(Yn[Un++]);for(var Kn=nt(ht.store),Jn=0;Kn.length>Jn;)sn(Kn[Jn++]);N(N.S+N.F*!An,"Symbol",{for:function(t){return H(Nn,t+="")?Nn[t]:Nn[t]=xn(t)},keyFor:function(t){if(!Gn(t))throw TypeError(t+" is not a symbol!");for(var e in Nn)if(Nn[e]===t)return e},useSetter:function(){Bn=!0},useSimple:function(){Bn=!1}}),N(N.S+N.F*!An,"Object",{create:function(t,e){return void 0===e?ut(t):Fn(ut(t),e)},defineProperty:zn,defineProperties:Fn,getOwnPropertyDescriptor:Wn,getOwnPropertyNames:Zn,getOwnPropertySymbols:Vn}),Pn&&N(N.S+N.F*(!An||g(function(){var t=xn();return"[null]"!=Sn([t])||"{}"!=Sn({a:t})||"{}"!=Sn(Object(t))})),"JSON",{stringify:function(t){for(var e,n,o=[t],r=1;arguments.length>r;)o.push(arguments[r++]);if(n=e=o[1],(v(e)||void 0!==t)&&!Gn(t))return hn(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Gn(e))return e}),o[1]=e,Sn.apply(Pn,o)}}),xn[On][jn]||O(xn[On],jn,xn[On].valueOf),pt(xn,"Symbol"),pt(Math,"Math",!0),pt(h.JSON,"JSON",!0),sn("asyncIterator"),sn("observable");var $n=f.Symbol,Xn=t(function(t){function e(t){return(e="function"==typeof $n&&"symbol"==typeof rn?function(t){return typeof t}:function(t){return t&&"function"==typeof $n&&t.constructor===$n&&t!==$n.prototype?"symbol":typeof t})(t)}function n(o){return"function"==typeof $n&&"symbol"===e(rn)?t.exports=n=function(t){return e(t)}:t.exports=n=function(t){return t&&"function"==typeof $n&&t.constructor===$n&&t!==$n.prototype?"symbol":e(t)},n(o)}t.exports=n});var Qn=function(t,e){if(e&&("object"===Xn(e)||"function"==typeof e))return e;if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},to=yn.f;en("getOwnPropertyDescriptor",function(){return function(t,e){return to(I(t),e)}});var eo=f.Object,no=function(t,e){return eo.getOwnPropertyDescriptor(t,e)};var oo=function t(e,n,o){null===e&&(e=Function.prototype);var r=no(e,n);if(void 0===r){var i=nn(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},ro=function(t,e){if(_(t),!v(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},io={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=p(Function.call,yn.f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,o){return ro(t,o),e?t.__proto__=o:n(t,o),t}}({},!1):void 0),check:ro};N(N.S,"Object",{setPrototypeOf:io.set});var ao=f.Object.setPrototypeOf;N(N.S,"Object",{create:ut});var co=f.Object,so=function(t,e){return co.create(t,e)};var lo=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=so(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(ao?ao(t,e):t.__proto__=e)},uo="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",ho="["+uo+"]",fo=RegExp("^"+ho+ho+"*"),po=RegExp(ho+ho+"*$"),vo=function(t,e,n){var o={},r=g(function(){return!!uo[t]()||"​"!="​"[t]()}),i=o[t]=r?e(_o):uo[t];n&&(o[n]=i),N(N.P+N.F*r,"String",o)},_o=vo.trim=function(t,e){return t=String(u(t)),1&e&&(t=t.replace(fo,"")),2&e&&(t=t.replace(po,"")),t},go=vo,mo=h.parseInt,yo=go.trim,wo=/^[-+]?0[xX]/,bo=8!==mo(uo+"08")||22!==mo(uo+"0x16")?function(t,e){var n=yo(String(t),3);return mo(n,e>>>0||(wo.test(n)?16:10))}:mo;N(N.S+N.F*(Number.parseInt!=bo),"Number",{parseInt:bo});var ko=parseInt,Eo=function(){function t(e){Ze(this,t),this.initProperties(e)}return Ke(t,[{key:"initProperties",value:function(t){this.project_id=t.project_id,this.platform_name=t.platform_name,this.product_id=t.product_id,this.platform_data=t.platform_data||{},this.widget_type=t.widget_type,this.widget_content=t.widget_content,this.isPreview=t.isPreview,this.octopusTags=t.octopusTags,this.articleTitle=t.articleTitle,this.pv_link=t.pv_link,this.pv_load_link=t.pv_load_link,this.label=t.label||"noLabel",this.click_link=t.click_link,this.zone3_type=t.zone3_type,this.ga=t.widget_content.ga,this.delayTime=1e3,this.supportsPassive=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}()}},{key:"initGoogleAnalytics",value:function(){var t,e,n,o,r;t=window,e=document,n="ga",t.GoogleAnalyticsObject=n,t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,o=e.createElement("script"),r=e.getElementsByTagName("script")[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",r.parentNode.insertBefore(o,r),ga("create",this.widget_content.ga,"auto",{name:this.gaName}),ga("".concat(this.gaName,".send"),"pageview")}},{key:"recordPaEvent",value:function(t){if(!this.isPreview){_piq.push(["trackEvent","octopusProject",t,this.project_id,ko(this.project_id,10)]),_piq.push(["trackEvent","octopusSupplier",t,this.platform_name,ko(this.project_id,10)]),_piq.push(["trackEvent","octopusWidget",t,this.widget_type,ko(this.project_id,10)]),_piq.push(["trackEvent","octopusProductId",t,this.product_id,ko(this.project_id,10)]);for(var e=this.octopusTags.length,n=0;n<e;n++)_piq.push(["trackEvent","octopusTag",t,this.octopusTags[n],ko(this.project_id,10)])}}},{key:"sendTrackEvent",value:function(t){(new Image).src=t}}]),t}(),xo=function(t){function e(){return Ze(this,e),Qn(this,(e.__proto__||nn(e)).apply(this,arguments))}return lo(e,Eo),Ke(e,[{key:"initProperties",value:function(t){oo(e.prototype.__proto__||nn(e.prototype),"initProperties",this).call(this,t),this.gaName="relatedPrdTracker"}},{key:"bindEvent",value:function(t){var n=this;t.addEventListener("click",function(t){var o,r,i=document.querySelector(".related__content"),a=t.target,c={related__title:"title",related__subtitle:"description",related__img:"image",related__reserve:"button"},s="other";n.isDescendant(i,a)&&(s="description");for(var l in c)if(0<=a.className.indexOf(l)){s=c[l];break}n.widget_content.link?(n.recordGaEvent("click",!0),n.recordPaEvent("click_"+s),oo(e.prototype.__proto__||nn(e.prototype),"sendTrackEvent",n).call(n,"".concat(n.click_link,"?position=").concat(s)),"related"===a.className&&(o="".concat(n.widget_content.link),(r=document.createElement("a")).href=o,r.target="_blank",r.rel="noopener",r.click())):t.preventDefault()});window.addEventListener("scroll",function o(){window.requestAnimationFrame(function(){t.offsetTop<window.pageYOffset+window.screen.height&&t.offsetTop+t.offsetHeight>window.pageYOffset&&(oo(e.prototype.__proto__||nn(e.prototype),"sendTrackEvent",n).call(n,n.pv_link),n.recordGaEvent("scroll_into_view",!0),window.removeEventListener("scroll",o))})},!!this.supportsPassive&&{passive:!0})}},{key:"isDescendant",value:function(t,e){for(var n=e.parentNode;null!=n;){if(n==t)return!0;n=n.parentNode}return!1}},{key:"gtmImpsEvent",value:function(){dataLayer.push({event:"genericPageview",eventUA:this.widget_content.ga,eventContentGroup1:"".concat(this.project_id,"_RP")})}},{key:"trace",value:function(){var t=this;this.isPreview||(oo(e.prototype.__proto__||nn(e.prototype),"initGoogleAnalytics",this).call(this),oo(e.prototype.__proto__||nn(e.prototype),"recordPaEvent",this).call(this,"imps"),setTimeout(function(){t.recordGaEvent("load",!1),t.recordPaEvent("load")},this.delayTime),this.gtmImpsEvent())}},{key:"recordGaEvent",value:function(t,e){this.isPreview||ga("".concat(this.gaName,".send"),"event","".concat(this.project_id,"_RP"),t,{nonInteraction:!e})}},{key:"recordPaEvent",value:function(t){_piq.push(["trackEvent","".concat(this.project_id,"_RP"),t,this.label])}},{key:"compileHtml",value:function(){return function(t){var e=t.description||"",n=t.img_link||"",o=t.title,r=t.link,i=t.price||"",a=t.original_price||"",c=t.button_name,s=t.html||"",l="";e&&(l='<a href="'.concat(r,'" target="_blank" rel="nofollow noopener"><span class="related__subtitle">').concat(e,"</span></a>"));var u="";n&&(u='<a href="'.concat(r,'" target="_blank" rel="nofollow noopener"><img class="related__img" src="').concat(n,'"></a>'));var h="";return s&&(h='<a href="'.concat(r,'" target="_blank" rel="nofollow noopener">').concat(s,"</a>")),'\n            <div class="related" data-title="'.concat(o,'" data-link="').concat(r,'" data-price="').concat(i,'" data-original-price="').concat(a,'" data-description="').concat(e,'" data-img-link="').concat(n,'" data-button-name="').concat(c,'">\n                <a href="').concat(r,'" target="_blank" rel="nofollow noopener"><h3 class="related__title">').concat(o,"</h3></a>\n                ").concat(l,"\n                ").concat(u,"\n                ").concat(h,'\n                <a class="related__reserve" href="').concat(r,'" target="_blank" rel="nofollow noopener">').concat(c,"</a>\n            </div>")}(this.widget_content)}}]),e}(),Po=Object.assign,So=!Po||g(function(){var t={},e={},n=Symbol(),o="abcdefghijklmnopqrst";return t[n]=7,o.split("").forEach(function(t){e[t]=t}),7!=Po({},t)[n]||Object.keys(Po({},e)).join("")!=o})?function(t,e){for(var n=gt(t),o=arguments.length,r=1,i=ln.f,a=un.f;o>r;)for(var c,s=M(arguments[r++]),l=i?nt(s).concat(i(s)):nt(s),u=l.length,h=0;u>h;)a.call(s,c=l[h++])&&(n[c]=s[c]);return n}:Po;N(N.S+N.F,"Object",{assign:So});var Oo,To=f.Object.assign,jo=function(t){function e(){return Ze(this,e),Qn(this,(e.__proto__||nn(e)).apply(this,arguments))}return lo(e,Eo),Ke(e,[{key:"initProperties",value:function(t){var n=this;oo(e.prototype.__proto__||nn(e.prototype),"initProperties",this).call(this,t),this.gaName="hotelcTracker",this.widget_content.ga="UA-65168598-12",this.platform_data.date={},this.label=t.label,this.firstResult=!0,this.isHotel="hotels_compare"===this.widget_type,this.today=new Date,this.todayStr=this.formateDate(this.today),this.stateNow="loading",this.defaultDate={hotelcCheckin:this.formateDate(new Date(this.today.getTime()+6048e5)),hotelcCheckout:this.formateDate(new Date(this.today.getTime()+6912e5))},this.isHotelRecommendDiy="hotel_recommend_diy"===t.widget_type,this.traceResult={result:function(){n.recordGaEvent("API result","API戳成功"),n.recordHotelcPaEvent("load")},fail:function(){n.recordGaEvent("API result","API戳失敗"),n.recordHotelcPaEvent("load hotel fail")},nodata:function(){n.recordGaEvent("API result","API戳成功_沒有飯店"),n.recordHotelcPaEvent("load hotel fail")}}}},{key:"compileHtml",value:function(){var t=To({},this.widget_content,this.platform_data);return this.isHotelRecommendDiy?this.widget_content.html:function(t,e){var n=new Date,o=new Date(n.getTime()+6048e5),r=new Date(n.getTime()+6912e5),i=Xe(n),a=Xe(o),c=Xe(r),s=Xe(o,!0),l=Xe(r,!0),u=e.area_en||"",h=e.area_tw||"",f=e.name_en||"",d=e.name_tw||"",p=e.item_count||"",v=e.title,_=e.area_en||"",g=e.button_name||"",m=e.star_rating||"",y=e.image_url||"",w="";"off"===e.enable_entry_date&&(w='hidden="true"');var b="";return"off"===e.enable_exit_date&&(b='hidden="true"'),{hotels_compare:function(){for(var t="",e=0;e<m;e++)t+='<span class="hotelc__info__star--yellow"></span>';for(var n=m;n<5;n++)t+='<span class="hotelc__info__star--gray"></span>';var o="";return y&&(o="style=\"background-image: url('".concat(y,"')\"")),'<div class="hotelc-box" data-type="hotel" data-place="'.concat(u,'" data-name-en="').concat(f,'" data-name-tw="').concat(d,'">\n            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display: none;">\n                <defs>\n                    <g id="icon-arrow--down">\n                        <path d="M1 0l5 6.996m0 0L11 0" stroke-linecap="square" stroke="currentColor" fill="none"/>\n                    </g>\n                    <g id="icon-arrow--right" fill="none" fill-rule="evenodd">\n                        <path d="M-349-58H26V2h-375z"/>\n                        <path d="M0 12l6-6M0 0l6 6" stroke="currentColor" stroke-linecap="square"/>\n                    </g>\n                </defs>\n            </svg>\n            <div class="hotelc__header">').concat(v,'</div>\n            <div class="hotelc__block1">\n                <a id="hotelc-info" href="https://www.hotelscombined.com.tw/Hotel/Search?fileName=').concat(f,"&checkin=").concat(a,"&checkout=").concat(c,'&rooms=1&adults_1=2&languageCode=TW&a_aid=132653&label=hotelinfoSingle" target="_blank" rel="nofollow noopener">\n                    <div class="hotelc__info">\n                        <div>\n                            <div class="hotelc__info__img" ').concat(o,'></div>\n                        </div>\n                        <div>\n                            <div class="hotelc__info__name">').concat(d,'</div>\n                            <div class="hotelc__info__place">').concat(h,"</div>\n                            <div>\n                                ").concat(t,'\n                                <span class="hotelc__info__star__txt">').concat(m,'星級飯店</span>\n                            </div>\n                        </div>\n                    </div>\n                </a>\n                <div class="hotelc__date-btn-container">\n                    <div class="hotelc__date-btn" ').concat(w,'>\n                        <div class="hotelc__date-btn__text">入住日期</div>\n                        <div class="hotelc__date-btn__date">\n                            <span>').concat(s,'</span>\n                            <svg class="icon-arrow--down" viewBox="0 0 12 8">\n                                <use xlink:href="#icon-arrow--down"></use>\n                            </svg>\n                        </div>\n                    </div>\n                    <div class="hotelc__date-btn" ').concat(b,'>\n                        <div class="hotelc__date-btn__text">退房日期</div>\n                        <div class="hotelc__date-btn__date">\n                            <span>').concat(l,'</span>\n                            <svg class="icon-arrow--down" viewBox="0 0 12 8">\n                                <use xlink:href="#icon-arrow--down"></use>\n                            </svg>\n                        </div>\n                    </div>\n                    <div class="hotelc__date-inputs">\n                        <input class="hotelc__date-input" type="date" value="').concat(a,'" min="').concat(i,'">\n                        <input class="hotelc__date-input" type="date" value="').concat(c,'" min="').concat(c,'">\n                    </div>\n                </div>\n            </div>\n            \x3c!-- 資料讀取中 --\x3e\n            <div class="hotelc__loading">\n                <div class="hotelc__loading-icon">資料讀取中</div>\n                <a class="hotelc__loading-link hotelc-links" id="hotelc-link--loading-continue" href="https://www.hotelscombined.com.tw/Hotel/Search?fileName=').concat(f,"&checkin=").concat(a,"&checkout=").concat(c,'&rooms=1&adults_1=2&languageCode=TW&a_aid=132653&label=loadingSingle" target="_blank" rel="nofollow noopener">等不及了嗎，直接前往查看更多</a>\n            </div>\n            <div class="hotelc__result">\n                <ul class="hotelc__result__list single--b"></ul>\n                <div class="hotelc__notes hotelc__notes--last">\n                    <a class="hotelc-links" id="hotelc-link--more" href="https://www.hotelscombined.com.tw/Hotels/Search?destination=place:').concat(u,"&checkin=").concat(a,"&checkout=").concat(c,'&rooms=1&adults_1=2&languageCode=TW&sortField=consumerRating&a_aid=132653&label=moreSingle&sort=MinRate-asc" target="_blank" rel="nofollow noopener">看更多').concat(h,'飯店</a><br>\n                    <a class="hotelc-powerby" href="https://www.hotelscombined.com.tw?a_aid=132653&label=powerbySingle" target="_blank" rel="nofollow noopener">\n                        <img src="https://front.pixfs.net/coblog/img/logo--hotelc.png" class="hotelc-powerby__img" alt="資料提供：HotelsCombined">\n                    </a>\n                </div>\n            </div>\n            \x3c!-- 資料錯誤 --\x3e\n            <div class="hotelc__nodata">\n                <div class="hotelc__notes">\n                    由於資料過多<br>\n                    請前往 HotelsCombined 看詳細結果\n                </div>\n                <a class="hotelc__btn hotelc__btn--blue hotelc-links" id="hotelc-link--fail-continue" href="https://www.hotelscombined.com.tw/Hotel/Search?fileName=').concat(f,"&checkin=").concat(a,"&checkout=").concat(c,'&rooms=1&adults_1=2&languageCode=TW&a_aid=132653&label=nodataSingle" target="_blank" rel="nofollow noopener">\n                    立即前往\n                    <svg class="icon-arrow--right" viewBox="0 0 8 12">\n                        <use xlink:href="#icon-arrow--right"></use>\n                    </svg>\n                </a>\n            </div>\n        </div>')}(),hotels_recommend:'<div class="hotelc-box" data-type="place" data-place="'.concat(u,'" data-name-en="').concat(f,'" data-name-tw="').concat(d,'" data-item-count="').concat(p,'">\n            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display: none;">\n                <defs>\n                    <g id="icon-arrow--down">\n                        <path d="M1 0l5 6.996m0 0L11 0" stroke-linecap="square" stroke="currentColor" fill="none"/>\n                    </g>\n                    <g id="icon-arrow--right" fill="none" fill-rule="evenodd">\n                        <path d="M-349-58H26V2h-375z"/>\n                        <path d="M0 12l6-6M0 0l6 6" stroke="currentColor" stroke-linecap="square"/>\n                    </g>\n                </defs>\n            </svg>\n            <div class="hotelc__header">').concat(v,'</div>\n            <div class="hotelc__block1">\n                <div class="hotelc__date-btn-container">\n                    <div class="hotelc__date-btn" ').concat(w,'>\n                        <div class="hotelc__date-btn__text">入住日期</div>\n                        <div class="hotelc__date-btn__date">\n                            <span>').concat(s,'</span>\n                            <svg class="icon-arrow--down" viewBox="0 0 12 8">\n                                <use xlink:href="#icon-arrow--down"></use>\n                            </svg>\n                        </div>\n                    </div>\n                    <div class="hotelc__date-btn" ').concat(b,'>\n                        <div class="hotelc__date-btn__text">退房日期</div>\n                        <div class="hotelc__date-btn__date">\n                            <span>').concat(l,'</span>\n                            <svg class="icon-arrow--down" viewBox="0 0 12 8">\n                                <use xlink:href="#icon-arrow--down"></use>\n                            </svg>\n                        </div>\n                    </div>\n                    <div class="hotelc__date-inputs">\n                        <input class="hotelc__date-input" type="date" value="').concat(a,'" min="').concat(i,'">\n                        <input class="hotelc__date-input" type="date" value="').concat(c,'" min="').concat(c,'">\n                    </div>\n                </div>\n            </div>\n            \x3c!-- 資料讀取中 --\x3e\n            <div class="hotelc__loading">\n                <div class="hotelc__loading-icon">資料讀取中</div>\n                <a class="hotelc__loading-link hotelc-links" id="hotelc-link--loading-continue" href="https://www.hotelscombined.com.tw/Hotels/Search?destination=place:').concat(_,"&checkin=").concat(a,"&checkout=").concat(c,'&rooms=1&adults_1=2&languageCode=TW&sortField=consumerRating&a_aid=132653&label=loadingArea" target="_blank" rel="nofollow noopener">等不及了嗎，直接前往查看更多</a>\n            </div>\n            <div class="hotelc__result">\n                <ul class="hotelc__result__list multi--b"></ul>\n                <a class="hotelc__btn hotelc__btn--green hotelc-links" id="hotelc-link--more" href="https://www.hotelscombined.com.tw/Hotels/Search?destination=place:').concat(_,"&checkin=").concat(a,"&checkout=").concat(c,'&rooms=1&adults_1=2&languageCode=TW&sortField=consumerRating&a_aid=132653&label=moreArea" target="_blank" rel="nofollow noopener">\n                    ').concat(g,'\n                    <svg class="icon-arrow--right" viewBox="0 0 8 12">\n                        <use xlink:href="#icon-arrow--right"></use>\n                    </svg>\n                </a>\n                <div class="hotelc__notes hotelc__notes--last">\n                    <a class="hotelc-powerby" href="https://www.hotelscombined.com.tw?a_aid=132653&label=powerbyArea" target="_blank" rel="nofollow noopener">\n                        <img src="https://front.pixfs.net/coblog/img/logo--hotelc.png" class="hotelc-powerby__img" alt="資料提供：HotelsCombined">\n                    </a>\n                </div>\n            </div>\n            \x3c!-- 資料錯誤 --\x3e\n            <div class="hotelc__nodata">\n                <div class="hotelc__notes">\n                    由於資料過多<br>\n                    請前往 HotelsCombined 看詳細結果\n                </div>\n                <a class="hotelc__btn hotelc__btn--blue hotelc-links" id="hotelc-link--fail-continue" href="https://www.hotelscombined.com.tw/Hotels/Search?destination=place:').concat(_,"&checkin=").concat(a,"&checkout=").concat(c,'&rooms=1&adults_1=2&languageCode=TW&sortField=consumerRating&a_aid=132653&label=nodataArea" target="_blank" rel="nofollow noopener">\n                    立即前往\n                    <svg class="icon-arrow--right" viewBox="0 0 8 12">\n                        <use xlink:href="#icon-arrow--right"></use>\n                    </svg>\n                </a>\n            </div>\n        </div>'),hotels_search:'<div class="hotels-search">\n            <ins class="bookingaff" data-aid="846006" data-target_aid="835804" data-prod="nsb" data-width="265" data-height="360" data-lang="xt" data-currency="TWD">\n            \x3c!-- Anything inside will go away once widget is loaded. --\x3e\n                <a href="https://www.booking.com?aid=835804" target="_blank" rel="nofollow noopener">Booking.com</a>\n            </ins>\n        </div>'}[t]||""}(this.widget_type,t)}},{key:"compileScript",value:function(){var t=document.createElement("script");t.innerHTML='\n            (function(d, sc, u) {\n                var s = d.createElement(sc), p = d.getElementsByTagName(sc)[0]; s.type = \'text/javascript\';\n                s.async = true;\n                s.src = u + \'?v=\' + (+new Date());\n                p.parentNode.insertBefore(s,p);\n            })(document, \'script\', \'https://aff.bstatic.com/static/affiliate_base/js/flexiproduct.js\');\n            dataLayer.push({\n                "c2a" : "hotels",\n                "event" : "hotelc2a-hcsearch-imp",\n                "eventLabel": "BK2"\n            });',document.getElementsByTagName("head")[0].appendChild(t)}},{key:"trace",value:function(){if(this.isHotelRecommendDiy)this.initGoogleAnalytics();else{this.initSets();for(var t=this.hotelcBlock.result.querySelectorAll(".hotelc__table--avg--link"),e=t.length,n=0;n<e;n++){var o=t[n].dataset.label;this.recordHotelLabelPaEvent("imps",o)}}}},{key:"initGoogleAnalytics",value:function(){oo(e.prototype.__proto__||nn(e.prototype),"initGoogleAnalytics",this).call(this),this.contentGaGroup()}},{key:"initSets",value:function(){this.initGoogleAnalytics(),this.initDomElement(),this.initDate()}},{key:"bindEvent",value:function(t){var n=this;this.isHotelRecommendDiy?this.bindScrollIntoView(t):(t.addEventListener("click",function(t){var o,r=t.target;if(n.hotelcBlock.result.contains(r)&&!r.classList.contains("hotelc__notes")){var i="other";if(n.hotelcBlock.hotels.contains(r)){var a={hotelc__img:"image",hotelc__info__name:"title",hotelc__info__rating:"description",hotelc__info__place:"description",hotelc__logo:"description",hotelc__price:"description",hotelc__compare:"description"},c=n.findAncestor(r,"hotelc__table--avg--link"),s=(c&&c.dataset||{}).name;for(var l in a)if(0<=r.className.indexOf(l)){i=a[l];break}oo(e.prototype.__proto__||nn(e.prototype),"sendTrackEvent",n).call(n,"".concat(n.click_link,"?position=").concat(i,"&extra=").concat(s))}switch(r.id){case"hotelc-info":return n.recordGaEvent("導流 click","click_hotel info"),void n.recordHotelcPaEvent("click_hotel info");case"hotelc-link--more":return o=n.isHotel?"click_hotel_more word":"click_hotel_more button",n.recordGaEvent("導流 click",o),n.recordHotelcPaEvent("click_button"),void oo(e.prototype.__proto__||nn(e.prototype),"sendTrackEvent",n).call(n,"".concat(n.click_link,"?position=button"));case"hotelc-link--more-price":return n.recordGaEvent("導流 click","click_price compare_button"),n.recordHotelcPaEvent("click_button"),void oo(e.prototype.__proto__||nn(e.prototype),"sendTrackEvent",n).call(n,"".concat(n.click_link,"?position=button"));case"hotelc-link--loading-continue":return void n.recordGaEvent("導流 click","click_Continue_loading");case"hotelc-link--fail-continue":return void n.recordGaEvent("導流 click","click_Continue_nodata")}if("hotelc-powerby__img"===r.className)return n.recordGaEvent("導流 click","click_hclogo"),n.recordHotelcPaEvent("click_description"),void oo(e.prototype.__proto__||nn(e.prototype),"sendTrackEvent",n).call(n,"".concat(n.click_link,"?position=description"));var u=r.dataset.label;o=n.isHotel?"click_price compare":"click_hotel_list",n.recordGaEvent("導流 click",o,u),n.recordHotelcPaEvent("click_"+i),oo(e.prototype.__proto__||nn(e.prototype),"recordPaEvent",n).call(n,"click")}}),this.bindInputBtn(),this.bindScrollIntoView(t))}},{key:"bindScrollIntoView",value:function(t){var n=this;window.addEventListener("scroll",function o(){window.requestAnimationFrame(function(){t.offsetTop<window.pageYOffset+window.screen.height&&t.offsetTop+t.offsetHeight>window.pageYOffset&&(oo(e.prototype.__proto__||nn(e.prototype),"sendTrackEvent",n).call(n,n.pv_link),oo(e.prototype.__proto__||nn(e.prototype),"recordPaEvent",n).call(n,"imps"),n.recordHotelcPaEvent("imps"),n.recordGaEvent("scroll_into_view","scroll_into_view"),window.removeEventListener("scroll",o))})},!!this.supportsPassive&&{passive:!0})}},{key:"findAncestor",value:function(t,e){return t.classList.contains(e)?t:t.classList.contains("octopus")?t:this.findAncestor(t.parentElement,e)}},{key:"contentGaGroup",value:function(){var t=this.isHotel?"Hotel Compare Prices":"Hotel Recommend";ga("".concat(this.gaName,".set"),"contentGroup1",this.platform_data.name_en),ga("".concat(this.gaName,".set"),"contentGroup2",t)}},{key:"initDomElement",value:function(){this.inputBtn={fake:document.getElementsByClassName("hotelc__date-btn__date"),true:document.getElementsByClassName("hotelc__date-input")},this.links=document.getElementsByClassName("hotelc-links"),this.hotelcBlock={info:document.getElementsByClassName("hotelc__info")[0],loading:document.getElementsByClassName("hotelc__loading")[0],result:document.getElementsByClassName("hotelc__result")[0],fail:document.getElementsByClassName("hotelc__nodata")[0],hotels:document.getElementsByClassName("hotelc__result__list")[0]}}},{key:"initDate",value:function(){var t=this,e=function(e){var n=function(t){var e="; ".concat(document.cookie).split("; ".concat(t,"="));if(2===e.length)return e[1].split(";")[0];return!1}(e);return n&&n>t.defaultDate[e]?n:t.defaultDate[e]};this.changeHotelcDate(e("hotelcCheckin"),e("hotelcCheckout")),this.inputBtn.true[0].value=this.platform_data.date.checkin,this.inputBtn.true[1].value=this.platform_data.date.checkout,this.changeDateZh(0,this.platform_data.date.checkin),this.changeDateZh(1,this.platform_data.date.checkout)}},{key:"getHotelData",value:function(){var t,e,n=this,o={a_aid:132653,checkin_date:this.platform_data.date.checkin,checkout_date:this.platform_data.date.checkout,label:this.label};this.isHotel?(o.type="hotel",o.hotel_name=Qe(this.platform_data.name_en)):(o.type="place",o.hotel_place=Qe(this.platform_data.area_en),o.limit=this.widget_content.item_count||3),(t="https://hotels-collaborate.events.pixnet.net/api/hotelscombined.php",e=o,new ze(function(n,o){var r=new XMLHttpRequest,i="".concat(t,"?a_aid=").concat(e.a_aid,"&type=").concat(e.type,"&checkin_date=").concat(e.checkin_date,"&checkout_date=").concat(e.checkout_date,"&label=").concat(e.label,"&");i+="hotel"===e.type?"hotel_name=".concat(e.hotel_name):"hotel_place=".concat(e.hotel_place,"&limit=").concat(e.limit),r.open("GET",i,!0),r.onload=function(){200===r.status?n(r.response):o(r)},r.onerror=function(){o(r)},r.send()})).then(function(t){var e=JSON.parse(t);n.isHotel&&e.order_info?n.showResult(e.order_info):e.hotels&&Array.isArray(e.hotels)?n.showResult(e.hotels):n.changeState("nodata")},function(){n.changeState("fail")})}},{key:"changeState",value:function(t){var e=this;"loading"!==t&&this.traceResult[t]();"nodata"===t&&(t="fail"),e.hotelcBlock[e.stateNow].style.display="none",e.stateNow=t,e.hotelcBlock[t].style.display="block"}},{key:"showResult",value:function(t){var e="",n=t.length;if(this.isHotel){for(var o=0;o<n;o++){var r='<li class="hotelc__table--highline hotelc__table--highline--red">\n                        <a class="hotelc__table--avg hotelc__table--avg--link hotelc__table--avg--inside-border hotelc__table--avg--60" href="'.concat(t[o].book_url,'" target="_blank" data-label="1-').concat(s(t[o].logo),"-").concat(this.platform_data.name_tw,'" data-name="').concat(t[o].name,'">\n                            <div>\n                                <div class="hotelc__logo" style="background-image: url(\'').concat(t[o].logo,'\')"></div>\n                            </div>\n                            <div>\n                                <div class="hotelc__price hotelc__price--red">NT$<span>').concat(c(t[o].price),'</span></div>\n                            </div>\n                        </a>\n                    </li>\n                    <a class="hotelc__btn hotelc__btn--red" id="hotelc-link--more-price" href="').concat(t[o].book_url,'" target="_blank">').concat(this.widget_content.button_name,'\n                        <svg class="icon-arrow--right" viewBox="0 0 8 12"><use xlink:href="#icon-arrow--right"></use></svg>\n                    </a>');0<o&&(r='<li class="border-top-1">\n                            <a class="hotelc__table--avg hotelc__table--avg--link hotelc__table--avg--inside-border hotelc__table--avg--60" href="'.concat(t[o].book_url,'" target="_blank" data-label="').concat(o+1,"-").concat(s(t[o].logo),"-").concat(this.platform_data.name_tw,'">\n                                <div>\n                                    <div class="hotelc__logo" style="background-image: url(\'').concat(t[o].logo,'\')"></div>\n                                </div>\n                                <div>\n                                    <div class="hotelc__price">NT$<span>').concat(c(t[o].price),"</span></div>\n                                </div>\n                            </a>\n                        </li>")),"https://cdn.datahc.com/Images/providers/logos/"===t[o].logo&&(r=r.replace(" style=\"background-image: url('".concat(t[o].logo,"')\""),"")),e+=r}this.hotelcBlock.result.querySelectorAll(".hotelc__result__list")[0].innerHTML=e}else{for(var i=0;i<n;i++){var a='<li class="hotelc__result--multi border-top-1">\n                        <a class="hotelc__table--avg--link" href="'.concat(t[i].book_url,'" target="_blank" data-label="').concat(i+1,"-").concat(s(t[i].logo),"-").concat(t[i].name,'" data-name="').concat(t[i].name,'">\n                            <div class="hotelc__table--avg hotelc__table--avg--scale">\n                                <div>\n                                    <div class="full-width">\n                                        <img src="').concat(t[i].hotel_img,'" class="hotelc__img">\n                                    </div>\n                                </div>\n                                <div>\n                                    <div class="full-width wrap-normal">\n                                        <span class="hotelc__info__rating">網友評分：').concat(t[i].guest_rating,'</span>\n                                        <br>\n                                        <span class="hotelc__info__name">').concat(t[i].name,'</span>\n                                        <br>\n                                        <span class="hotelc__info__place">').concat(t[i].place_name,'</span>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="hotelc__table--avg hotelc__table--avg--inside-border hotelc__table--avg--60">\n                                <div>\n                                    <div class="hotelc__logo" style="background-image: url(\'').concat(t[i].logo,'\')"></div>\n                                </div>\n                                <div>\n                                    <div class="text-right nowrap">\n                                        <div class="hotelc__price hotelc__price--green">NT$<span>').concat(c(t[i].price),'</span>\n                                            <svg class="icon-arrow--right" viewBox="0 0 8 12">\n                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-arrow--right"></use>\n                                            </svg>\n                                        </div>\n                                        <div class="hotelc__compare">比較 ').concat(t[i].providers_num," 個網站最低價</div>\n                                    </div>\n                                </div>\n                            </div>\n                        </a>\n                    </li>");t[i].hotel_img||(a=a.replace('<img src="'.concat(t[i].hotel_img,'">'),"")),"https://cdn.datahc.com/Images/providers/logos/"===t[i].logo&&(a=a.replace(" style=\"background-image: url('".concat(t[i].logo,"')\""),"")),e+=a}this.hotelcBlock.result.querySelectorAll("ul")[0].innerHTML=e}function c(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function s(t){var e=t.split("/");return e=e[e.length-1].split("-")[0].split(".")[0]}this.changeState("result")}},{key:"bindInputBtn",value:function(){var t=this,e=function(){var e=t.inputBtn.true[0].value,n=t.inputBtn.true[1].value;t.todayStr<=e&&e<n&&(t.changeHotelcDate(e,n),t.changeState("loading"),setTimeout(function(){t.getHotelData()},500))};e();var n=function n(){var r=t.inputBtn.true[1].value,i=!isNaN(new Date(r).getTime()),a=t.inputBtn.true[1].getAttribute("min"),c=new Date(new Date(r).getTime()-864e5),s=t.formateDate(c);i?(t.changeDateZh(1,t.inputBtn.true[1].value),t.inputBtn.true[0].value>=r?(t.inputBtn.true[0].value=s,o()):e()):(t.inputBtn.true[1].value=a,t.changeDateZh(1,t.today),n())},o=function o(){var r=t.inputBtn.true[0].value,i=!isNaN(new Date(r).getTime()),a=new Date(new Date(r).getTime()+864e5),c=t.formateDate(a);!i||t.todayStr>r?(t.inputBtn.true[0].value=t.todayStr,t.changeDateZh(0,t.today),o()):(t.changeDateZh(0,r),t.inputBtn.true[1].setAttribute("min",c),t.inputBtn.true[1].value<=r?(t.inputBtn.true[1].value=c,n()):e())};this.inputBtn.fake[0].addEventListener("click",function(){t.inputBtn.true[0].click(),t.inputBtn.true[0].focus(),t.recordGaEvent("互動 click","check in"),t.recordHotelcPaEvent("click_check in")}),this.inputBtn.fake[1].addEventListener("click",function(){t.inputBtn.true[1].click(),t.inputBtn.true[1].focus(),t.recordGaEvent("互動 click","check out"),t.recordHotelcPaEvent("click_check out")}),this.inputBtn.true[0].addEventListener("change",o),this.inputBtn.true[1].addEventListener("change",n)}},{key:"changeHotelcDate",value:function(t,e){for(var n=this,o=function(t,e){if(/^(\d{4})-(\d{2})-(\d{2})$/.test(e)&&!isNaN(new Date(e).getTime())){var o=(new Date).setTime(n.today.getTime()+6048e5);document.cookie="".concat(t,"=").concat(e,";domain=.pixnet.net;path=/;expires=").concat(new Date(o).toGMTString())}},r="checkin=".concat(this.platform_data.date.checkin,"&checkout=").concat(this.platform_data.date.checkout),i="checkin=".concat(t,"&checkout=").concat(e),a=this.links.length,c=0;c<a;c++){var s=this.links[c].getAttribute("href").replace(r,i);this.links[c].setAttribute("href",s)}this.platform_data.date.checkin=t,this.platform_data.date.checkout=e,o("hotelcCheckin",t),o("hotelcCheckout",e)}},{key:"changeDateZh",value:function(t,e){var n=new Date(e);this.inputBtn.fake[t].querySelectorAll("span")[0].textContent="".concat(n.getFullYear()," 年 ").concat(n.getMonth()+1," 月 ").concat(n.getDate()," 日")}},{key:"formateDate",value:function(t){var e=t.getFullYear(),n="0".concat(t.getMonth()+1).slice(-2),o="0".concat(t.getDate()).slice(-2);return"".concat(e,"-").concat(n,"-").concat(o)}},{key:"recordGaEvent",value:function(t,e,n){ga("".concat(this.gaName,".send"),"event",t,e,n)}},{key:"recordHotelcPaEvent",value:function(t){var e=this.isHotel?"Hotel Compare Prices":"Hotel Recommend";_piq.push(["trackEvent",e,t,this.label])}},{key:"recordHotelLabelPaEvent",value:function(t,e){_piq.push(["trackEvent","octopusHotelLabel",t,"".concat(this.label,":::").concat(e)])}}]),e}(),Lo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Ze(this,t),this.categoryId="",this.octopusTags=[],this.articleTitle="",this.widgetParams="",this.fuzzyWidgetParams="",this.articleTitle="",this.octopusDom={},this.projectId=Je("project_id")||"",this.isPreview=!!this.projectId,this.zone1=[],this.zone2=[],this.zone3=[],this.activeCta="",this.activeRp="",this.init(e)}var e;return Ke(t,[{key:"init",value:function(t){this.setConfig(t),this.serializeData()}},{key:"setConfig",value:function(t){var e=this;t.map(function(t){var n=t[0],o=t[1];n in e&&"function"!=typeof o&&(e[n]=o)})}},{key:"serializeData",value:function(){this.fuzzyWidgetParams="?category_id=".concat(this.categoryId,"&article_title=").concat(encodeURIComponent(this.articleTitle),"&project_id=").concat(this.projectId),this.widgetParams=this.octopusTags.map(function(t){return"tags[]=".concat(encodeURIComponent(t))}).join("&"),this.widgetParams+="&category_id=".concat(this.categoryId,"&article_title=").concat(encodeURIComponent(this.articleTitle),"&project_id=").concat(this.projectId)}},{key:"run",value:(e=Fe(a.mark(function t(){var e,n;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,$e.get("https://octopus.pixanalytics.com/widgets/fuzzy"+this.fuzzyWidgetParams);case 3:if(e=t.sent,0!==this.octopusTags.length||this.isPreview){t.next=10;break}if(!e.error){t.next=8;break}return this.noMatchWidget(),t.abrupt("return");case 8:t.next=17;break;case 10:return t.next=12,$e.post("https://octopus.pixanalytics.com/widgets",this.widgetParams);case 12:if(n=t.sent,!e.error||!n.error){t.next=16;break}return this.noMatchWidget(),t.abrupt("return");case 16:this.addWidgets(n);case 17:this.addWidgets(e),this.generate(),t.next=23;break;case 21:t.prev=21,t.t0=t.catch(0);case 23:case"end":return t.stop()}},t,this,[[0,21]])})),function(){return e.apply(this,arguments)})},{key:"addWidgets",value:function(t){t.error||t.widgets&&(t.widgets.Zone1&&this.zone1.push(t.widgets.Zone1),t.widgets.Zone2&&this.zone2.push(t.widgets.Zone2),t.widgets.Zone3&&this.zone3.push(t.widgets.Zone3))}},{key:"generate",value:function(){var t=this.couldShowOctopus();t.zone1?this.setOctopusIntoZone(this.zone1,1):this.noMatchRelated(),t.zone2&&this.setOctopusIntoZone(this.zone2,2),t.zone3?this.setOctopusIntoZone(this.zone3,3):this.noMatchCta()}},{key:"setOctopusIntoZone",value:function(t,e){var n,o,r,i=(o=(n=t).map(function(t){return t.priority}).reduce(function(t,e){return Math.min(t,e)}),n.filter(function(t){return o===t.priority})),a=i[Math.floor(Math.random()*i.length)];switch(a.isPreview=this.isPreview,a.octopusTags=this.octopusTags,e){case 1:this.activeRp=a.widget_type,r=new xo(a);break;case 2:r=new jo(a);break;case 3:this.activeCta=a.widget_type,window.PixnetHappixPilot&&PixnetHappixPilot.setGiftNotificationData(a)}We(this.octopusDom).map(function(t){t.dataset.zone===e.toString()&&"done"!==t.dataset.process&&(t.innerHTML=r.compileHtml(),r.isHotelRecommendDiy&&(!function t(e){if("SCRIPT"===e.tagName)return e.parentNode.replaceChild(tn(e),e),e;for(var n=0,o=e.childNodes;n<o.length;)t(o[n++]);return e}(t),t.classList.add("recommend-diy")),r.trace(),r.bindEvent(t),t.dataset.process="done")})}},{key:"couldShowOctopus",value:function(){var t={zone1:!0,zone2:!0,zone3:!0};return We(this.octopusDom).some(function(t){return"1"===t.dataset.zone})||(t.zone1=!1),We(this.octopusDom).some(function(t){return"2"===t.dataset.zone})||(t.zone2=!1),We(this.octopusDom).some(function(t){return"3"===t.dataset.zone})||(t.zone3=!1),0===this.zone1.length&&(t.zone1=!1),0===this.zone2.length&&(t.zone2=!1),0===this.zone3.length&&(t.zone3=!1),"cta_diy"===this.activeCta&&(t.zone3=!1),t}},{key:"noMatchRelated",value:function(){this.activeRp="ctaRelated"}},{key:"noMatchCta",value:function(){window.PixnetHappixPilot&&PixnetHappixPilot.activateHappixNotificationFlow(),this.activeCta=this.activeCta||"eztableOrHotels"}},{key:"noMatchWidget",value:function(){this.noMatchRelated(),this.noMatchCta()}},{key:"getActiveOctopus",value:function(){return{activeRp:this.activeRp,activeCta:this.activeCta}}}]),t}();(Oo=Fe(a.mark(function t(e){var n;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Lo(e._oq),t.next=3,n.run();case 3:e.pix.activeRp=n.getActiveOctopus().activeRp,e.pix.activeCta=n.getActiveOctopus().activeCta;case 5:case"end":return t.stop()}},t,this)})),function(t){return Oo.apply(this,arguments)})(window),window.OctopusSDK=Lo}();
